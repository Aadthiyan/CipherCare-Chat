services:
  - type: web
    name: cyborgdb
    env: docker
    dockerfilePath: ./docker/cyborgdb.Dockerfile
    plan: starter
    region: oregon
    disk:
      name: cyborgdb-data
      mountPath: /data
      sizeGB: 10
    envVars:
      - key: CYBORGDB_PORT
        value: "8002"
      - key: CYBORGDB_HOST
        value: "0.0.0.0"
    healthCheckPath: /health
    port: 8002

  - type: web
    name: backend
    env: docker
    dockerfilePath: ./docker/backend.Dockerfile
    plan: starter
    region: oregon
    envVars:
      - key: DATABASE_URL
        value: ${DATABASE_URL}
      - key: CYBORGDB_API_KEY
        value: ${CYBORGDB_API_KEY}
      - key: CYBORGDB_BASE_URL
        value: http://cyborgdb:8002
      - key: HUGGINGFACE_API_KEY
        value: ${HUGGINGFACE_API_KEY}
      - key: HUGGINGFACE_MODEL_NAME
        value: ${HUGGINGFACE_MODEL_NAME}
      - key: EMBEDDING_DIMENSION
        value: ${EMBEDDING_DIMENSION}
    healthCheckPath: /health
    port: 8000

# Notes:
# - This config deploys both CyborgDB and the backend as Docker services on Render.
# - The backend is configured to use the internal service name `http://cyborgdb:8002` so
#   both services run in the same Render project network and can resolve each other by name.

